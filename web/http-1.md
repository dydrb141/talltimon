# HTTPS 동작 방식

### SSL과 TLS

* SSL\(Secure Sockets Layers\) 와 TLS\(Transport Layer Security\) 같은것이라고 할 수 있음.
*  SSL은 TCP/IP 암호화 통신에 사용되는 규약으로 넷스케이프에서 만듬
*  SSL 3.0 부터느 IETF에서 표준으로 정해서 TLS1.0이 됨

### 대칭키 암호화 비대칭키 암호

* SSL에서는 데이터를 암호화해서 전송하므로 대칭키 암호화 비대칭키 암호가 있음
* 대칭키 - 키 하나로 암호화 복호화를 하는 방식  대표 방식에는 AES 대칭키 방식의 암호화
*                장점 : 대칭키 암복호화 방식은 비대칭키 암호화 방식보다는 빠름
*                단점 :  하나의 키로 암 복화를 하기 때문에 보안에 취약함     
* 비대칭키 \(공개키 방식\) - 두 개의 키로 암 복화화 하는 방식, 대칭키의 보안을 보안하고자 나온 방식

### CA

* 클라이언트에 접속한 서버가 클라이언트가 의도한 서버가 맞는지 보장
* 이 역할을 하는 민간 기업을 CA \(Certificate authority\) 라 부름
* 엄격하게 선별된 기업만 할 수 있고 그중 Symantec, Comodo가 대표적임
* 브라우저는 내부적으로 ca의 리스트를 미리 파악
* 브라우저에서 미리 파악하고 있는 CA 리스트에 포함되어야만 공인된 CA가 될수 있음

### Ssl의 동작 방법

ssl은 암호화된 데이터를 전송하기 위해 공개키와 대칭키 를 혼합해서 사용

클라이언트와 서버가 주고 받는 실제 정보는 대칭키 방식으로 암호화

대칭키 방식으로 암호화된 실제 정보를 복호화할 때 

1. 클라이언트 헬로

 - 클라이언트 랜덤 데이터 생성

- 클라이언트가 지원하는 암호화 방식들 : 서버와 암호화 방식이 다를 수 있기 때문에 클라이언트측     이 사용할 수 있는 암호화 방식을 전달함

  2. 서버 헬로

 - 서버에서 랜덤 데이터  생성

 - 서버가 선택한 클라이언트 암호화 방식 : 클라이언트에서 전송한 암호화 방식중 서버에서 사용할 수 잇는 암호화 방식을 선택해 클라이언트로 전달

  3.인증서

1. 클라이언트에서는 서버에서 보낸 인증서를 CA리스트 기반으로 확인함. 인증서가 없다면 경고 메세지 출력 

      - 클라이언트는 내장된 Ca의 공개키를 이용해 인증서를 복호화 

      - 복호화에 성곡했다면 인증서는 ca의 개인크로 암호화 된 문서임을 보증

1. 클라이언트는 서버 랜덤 데이터와 클라이언드 랜덤 데이터를 조합해서 pre master secret키 새성 \(이 키는 데이터를 주고 받을때 암호화 하기 위해 사용\)
2. 공개키로 pre master secretr키를 암호화 해서 서버에 전송
3. 서버는 비공개키로 복호화 \(서버의 공개키는 서버로부터 받은 인증서 안에 들어있음\)
4. 서버는 pre master secret값을 자신의 비공개키로 복호화
5. 서버와 클라이언트는 pre master secret값을 master secret값으로 만들고 master secret는 session key를 생성하여 대칭키 방식으로 암복호화 함.

참고 : [https://opentutorials.org/course/228/4894](https://opentutorials.org/course/228/4894)

