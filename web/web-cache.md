# WEB Cache

성능 개선을 위해 폭넓게 사용되는 기법 크게 브라우저 캐치와 서버 캐시로 나뉜다.

## 브라우저 캐시 \(Browser Cache\)

HTTP 응답 크기를 줄이는 방식과 HTTP 요청 수를 줄이는 방식이 있다.

### HTTP 응답 크기를 줄이는 방식

1. 요청 1\) 웹 서버에 정적 컨텐츠 요청
2. 응답\) 200ok 헤더에 Last-Modified:Mon, 22 Jul 2019 01:56:23 GMT
3. 브라우저 캐시에 저장
4. 요청 2\) 웹 서버에 정적 컨텐츠 요청 헤더에 if-Modified-Since: Mon, 22 Jul 2019 01:56:23 GMT 웹 서버 요청
5. 웹 서버는  컨텐츠 변경 일자를 비교해서 동일한 컨텐츠이면 브라우저 캐시에 있는 컨텐츠를 사용하라고 304 Not Modified를 응답

웹 서버의 요청수는 줄어들지는 않고 응답 본문에 컨텐츠 내용이 없어 응답 크기가 줄어듬

#### ETag\(Entity Tag\)

기본적으로 정해놓은 값을 가지고 MD5 Hash등의 방법으로 고유한 값 각 웹서버마다 다르며 아치치의 경우는 Inode + MTime +Size \(선택적 설정가능\) 방식으로 고유 값을 만들어 ETag와 Last-Modified를 가지고 유효성을 체크함 아파치 설정으로 사용안할 수도 있다.

### HTTP 요청 수를 줄이는 캐시 방식

Cache-Control 속성을 이용해 HTTP 요청 자체를 하지 않도록 하는 방식 

Cache-Control의 max-age 설정값을 통해 응답이 내려간 이후 일정동안 서버에 요청 자체를 하지 않음 

문제는 해당 컨텐츠가 변경되더라도 설정한 일정 시간 동안 갱신이 안된다.

#### Cache-Control 설정값

* no-cache: 캐시 사용 하지 않음, etag 유효성은 체크 
* no-store: 응답을 저장하지 않음, 매번 새로운 요청\(프락시 브라우저 모두\)
* private: 여러 사용자가 공유하는 프락시에는 캐시 불가, 개인이 사용하는 브라우저에만 캐시
* max-age: max-age가 경과할때 까지는 웹 서버 요청을 하지 않고 캐시의 컨텐츠 사용

  

